# –≠–∫—Å–ø–æ—Ä—Ç RVT

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–¥–µ–ª–µ–π Revit (–≤–∫–ª—é—á–∞—è Revit Server) –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É —á–µ—Ä–µ–∑ pyRevit.

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–µ–ª–µ–π —Å Revit Server/–ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Ö –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏ –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (detach) –∏ –æ–ø—Ü–∏—è–º–∏ –æ—á–∏—Å—Ç–∫–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–∞–∫–µ—Ç–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö RVT-—Ñ–∞–π–ª–æ–≤ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫
- **–†–µ–∂–∏–º—ã detach**:
  - `preserve`: Detach & Preserve Worksets + SaveAsCentral
  - `discard`: Detach & Discard Worksets
  - `none`: –æ—Ç–∫—Ä—ã—Ç–∏–µ –±–µ–∑ detach
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –æ—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–æ–≤ –±–µ–∑ —Ä–∞–±–æ—á–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ —Å–≤—è–∑–µ–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**:
  - –£–¥–∞–ª–µ–Ω–∏–µ CAD –∏–º–ø–æ—Ä—Ç–æ–≤ (DWG/DXF)
  - –£–¥–∞–ª–µ–Ω–∏–µ CAD —Å–≤—è–∑–µ–π
  - –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç—Ä–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - Purge Unused (–º–Ω–æ–≥–æ–ø—Ä–æ—Ö–æ–¥–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—É—Ç–µ–π –Ω–∞ –ø–∞–ø–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π**: –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤ Revit

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–æ–¥—É–ª–∏ (lib/)
- `openbg.py` - –º–æ–¥—É–ª—å —Ñ–æ–Ω–æ–≤–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –†–ù –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- `closebg.py` - –º–æ–¥—É–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### Revit API
- `ModelPathUtils`, `OpenOptions`, `DetachFromCentralOption`
- `SaveAsOptions`, `WorksharingSaveAsOptions`
- `TransmissionData` - –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π
- `PerformanceAdviser` - –¥–ª—è Purge Unused

### pyRevit
- `script`, `coreutils`, `forms` - UI, —Ç–∞–π–º–µ—Ä—ã, –¥–∏–∞–ª–æ–≥–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫

```python
DETACH_MODE = "preserve"  # "preserve" | "discard" | "none"
COMPACT_ON_SAVE = True
OVERWRITE_SAME = True
```

### –õ–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `get_workset_filter()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–∏–∫–∞—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

```python
def get_workset_filter():
    def workset_filter(ws_name):
        name = (ws_name or u"").strip()
        # –ò—Å–∫–ª—é—á–∞–µ–º: –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å '00_'
        if name.startswith(u'00_'):
            return False
        # –ò—Å–∫–ª—é—á–∞–µ–º: —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ 'Link' –∏–ª–∏ '–°–≤—è–∑—å'
        name_lower = name.lower()
        if u'link' in name_lower or u'—Å–≤—è–∑—å' in name_lower:
            return False
        return True
    return workset_filter
```

**–ù–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ä–∞–±–æ—á–∏–µ –Ω–∞–±–æ—Ä—ã:**
- –ù–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å `00_` (–∞—Ä—Ö–∏–≤–Ω—ã–µ)
- –°–æ–¥–µ—Ä–∂–∞—â–∏–µ `Link` (—Å–≤—è–∑–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º)
- –°–æ–¥–µ—Ä–∂–∞—â–∏–µ `–°–≤—è–∑—å` (—Å–≤—è–∑–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º)

### –§—É–Ω–∫—Ü–∏—è `open_document()`

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –≤—Å–µ —Ä–µ–∂–∏–º—ã detach:

- **Workshared —Ñ–∞–π–ª—ã**:
  - `preserve`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `openbg.open_in_background()` —Å `detach=True`
  - `discard`: –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ `app.OpenDocumentFile()` —Å —Ä—É—á–Ω—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º
  - `none`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `openbg.open_in_background()` —Å `detach=False`

- **–ù–µ-Workshared —Ñ–∞–π–ª—ã**: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–µ–∑ detach —á–µ—Ä–µ–∑ `openbg.open_in_background()`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: –∫–æ—Ä—Ç–µ–∂ `(doc, failure_handler)` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞ –æ–± –æ—à–∏–±–∫–∞—Ö

### –û—á–∏—Å—Ç–∫–∞ –º–æ–¥–µ–ª–∏

#### 1. –£–¥–∞–ª–µ–Ω–∏–µ CAD –∏–º–ø–æ—Ä—Ç–æ–≤
```python
def delete_cad_imports(doc):
    # –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ ImportInstance —Å IsLinked=False
    # –£–¥–∞–ª—è–µ—Ç –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```

#### 2. –£–¥–∞–ª–µ–Ω–∏–µ CAD —Å–≤—è–∑–µ–π
```python
def delete_cad_links(doc):
    # –£–¥–∞–ª—è–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä—ã —Å–≤—è–∑–µ–π (ImportInstance —Å IsLinked=True)
    # –£–¥–∞–ª—è–µ—Ç —Ç–∏–ø—ã CADLinkType
```

#### 3. –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç—Ä–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
def delete_raster_images(doc):
    # –£–¥–∞–ª—è–µ—Ç ImageInstance
    # –£–¥–∞–ª—è–µ—Ç ImageType
```

#### 4. Purge Unused (–º–Ω–æ–≥–æ–ø—Ä–æ—Ö–æ–¥–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `PerformanceAdviser` –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

```python
def purge_unused(doc):
    # –î–æ 20 –ø—Ä–æ—Ö–æ–¥–æ–≤ –æ—á–∏—Å—Ç–∫–∏
    # –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ö–æ–¥:
    #   - ExecuteRules() –¥–ª—è –ø–æ–∏—Å–∫–∞ purgeable —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    #   - –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    #   - –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
    #   - –ü–æ–≤—Ç–æ—Ä –¥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
```

**–í–∞–∂–Ω–æ**: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã, —Ç–∞–∫ –∫–∞–∫ —É–¥–∞–ª–µ–Ω–∏–µ –æ–¥–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –¥—Ä—É–≥–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π

–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—É—Ç–∏ –≤—Å–µ—Ö Revit-—Å–≤—è–∑–µ–π:

```python
def update_links_to_export_folder(saved_file_path, export_folder):
    # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç TransmissionData –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –ø—É—Ç–µ–π
    # –î–ª—è –∫–∞–∂–¥–æ–π RevitLink:
    #   - –ü–æ–ª—É—á–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ —Å–≤—è–∑–∏
    #   - –§–æ—Ä–º–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –ø—É—Ç—å –≤ –ø–∞–ø–∫–µ —ç–∫—Å–ø–æ—Ä—Ç–∞
    #   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PathType.Relative
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ WriteTransmissionData()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –≤—Å–µ —Å–≤—è–∑–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏.

### –ü—Ä–æ—Ü–µ—Å—Å —ç–∫—Å–ø–æ—Ä—Ç–∞

1. **–í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π**: `pick_file()` –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π `sup.select_file()`
2. **–í—ã–±–æ—Ä –ø–∞–ø–∫–∏**: `pick_folder()`
3. **–í—ã–±–æ—Ä –æ–ø—Ü–∏–π –æ—á–∏—Å—Ç–∫–∏**: –¥–∏–∞–ª–æ–≥ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏
4. **–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:**
   - –û—Ç–∫—Ä—ã—Ç–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –†–ù –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö
   - –£–¥–∞–ª–µ–Ω–∏–µ CAD –∏–º–ø–æ—Ä—Ç–æ–≤/—Å–≤—è–∑–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç—Ä–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - Purge Unused (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–Ω–æ–≥–æ–ø—Ä–æ—Ö–æ–¥–Ω–∞—è)
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å compact
   - –ó–∞–∫—Ä—ã—Ç–∏–µ –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—á–∏—Ö –Ω–∞–±–æ—Ä–æ–≤
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –†–ù —Å–æ —Å–≤—è–∑—è–º–∏ ‚Üí –±—ã—Å—Ç—Ä–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç—å

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SuppressWarningsPreprocessor` –∏–∑ `openbg.py`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥–∏ Revit
- –°–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ—Ç—á–µ—Ç–∞

### 3. Compact –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- `SaveAsOptions.Compact = True`
- –°–∂–∏–º–∞–µ—Ç —Ñ–∞–π–ª –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–∞ 10-30%

### 4. –ú–Ω–æ–≥–æ–ø—Ä–æ—Ö–æ–¥–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–æ 20 –ø—Ä–æ—Ö–æ–¥–æ–≤ Purge
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞

### 5. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Å–≤—è–∑–µ–π
- `PathType.Relative` –¥–ª—è –≤—Å–µ—Ö —Å–≤—è–∑–µ–π
- –£–ø—Ä–æ—â–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É –Ω–∞–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ –ø–∞–ø–∫–∏

## –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:
- –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É –∏ —Ü–µ–ª–µ–≤–æ–º—É —Ñ–∞–π–ª—É
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö/–æ—à–∏–±–∫–∞—Ö** (–µ—Å–ª–∏ –±—ã–ª–∏):
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫
  - –ü–µ—Ä–≤—ã–µ 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º
  - –ü–µ—Ä–≤—ã–µ 2 –æ—à–∏–±–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
  - CAD –∏–º–ø–æ—Ä—Ç—ã
  - CAD —Å–≤—è–∑–∏
  - –†–∞—Å—Ç—Ä–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ü—Ä–æ—Ö–æ–¥—ã Purge Unused —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π
- –í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (OK/–û—à–∏–±–∫–∞)

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
üìÇ Model_AR.rvt ‚Üí Z:\Export\Model_AR.rvt
  ‚ö†Ô∏è –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, 0 –æ—à–∏–±–æ–∫
    1. –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å—Å—ã–ª–∫–∏: –ö–†_–°–≤—è–∑—å.rvt
    2. –£–¥–∞–ª–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –≥—Ä—É–ø–ø—ã
    3. –£—Å—Ç–∞—Ä–µ–≤—à–µ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ
  üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ –ø–æ–¥–ª–æ–∂–µ–∫: 5
    CAD –∏–º–ø–æ—Ä—Ç—ã: 2
    CAD —Å–≤—è–∑–∏: 3
  üßπ –û—á–∏—â–µ–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: 247
    –ü—Ä–æ—Ö–æ–¥ 1: —É–¥–∞–ª–µ–Ω–æ 156 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    –ü—Ä–æ—Ö–æ–¥ 2: —É–¥–∞–ª–µ–Ω–æ 68 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    –ü—Ä–æ—Ö–æ–¥ 3: —É–¥–∞–ª–µ–Ω–æ 23 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  üîó –û–±–Ω–æ–≤–ª–µ–Ω–æ –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π –Ω–∞ –ø–∞–ø–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞: 2
- –û—Ç–∫—Ä—ã—Ç–∏–µ: 0:01:23, –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: 0:00:45 ‚Üí ‚úÖ OK
–ì–æ—Ç–æ–≤–æ: Z:\Export\Model_AR.rvt
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```python
DETACH_MODE = "preserve"  # —Ä–µ–∂–∏–º –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
COMPACT_ON_SAVE = True    # —Å–∂–∞—Ç–∏–µ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
OVERWRITE_SAME = True     # –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
```

### –ü–∞–ø–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```python
~/Documents/RVT_Detached
```

### –û–ø—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏ (–≤—ã–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ UI)
- –£–¥–∞–ª—è—Ç—å CAD –∏–º–ø–æ—Ä—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –¥–∞)
- –£–¥–∞–ª—è—Ç—å CAD —Å–≤—è–∑–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –¥–∞)
- –£–¥–∞–ª—è—Ç—å —Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –¥–∞)
- –û—á–∏—â–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –¥–∞)

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **Revit**: 2022, 2023 (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É API —á–µ—Ä–µ–∑ try/except)
- **pyRevit**: —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π pyRevit
- **Revit Server**: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ModelPath
- **Workshared —Ñ–∞–π–ª—ã**: –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤ detach
- **–ù–µ-Workshared —Ñ–∞–π–ª—ã**: –æ—Ç–∫—Ä—ã—Ç–∏–µ –±–µ–∑ detach

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Workshared-—Å—Ç–∞—Ç—É—Å–∞
```python
def is_workshared_file(mp):
    from Autodesk.Revit.DB import BasicFileInfo
    file_info = BasicFileInfo.Extract(...)
    return file_info.IsWorkshared
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–¥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è** —Ñ–∞–π–ª–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

### –†–µ–∂–∏–º—ã Detach

| –†–µ–∂–∏–º | DetachOption | WorksharingSaveAsOptions |
|-------|--------------|-------------------------|
| preserve | DetachAndPreserveWorksets | SaveAsCentral = True |
| discard | DetachAndDiscardWorksets | - |
| none | - | - |

### TransmissionData

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π **–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è** –¥–æ–∫—É–º–µ–Ω—Ç–∞:
- –ß—Ç–µ–Ω–∏–µ: `TransmissionData.ReadTransmissionData(mp)`
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ: `SetDesiredReferenceData(ref_id, new_path, PathType.Relative, True)`
- –ó–∞–ø–∏—Å—å: `TransmissionData.WriteTransmissionData(mp, trans_data)`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
–≠–∫—Å–ø–æ—Ä—Ç RVT.pushbutton/
‚îú‚îÄ‚îÄ rvt_export_script.py   # –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ bundle.yaml            # –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
‚îú‚îÄ‚îÄ icon.png               # –∏–∫–æ–Ω–∫–∞ –∫–Ω–æ–ø–∫–∏
‚îî‚îÄ‚îÄ claude.md              # —ç—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é
- –í—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è - –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- Purge –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª—è—Ö
- TransmissionData —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Å–≤—è–∑–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –ø–∞–ø–∫–∏

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π Revit
- [x] –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ–± –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö/–æ—à–∏–±–∫–∞—Ö
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (–±–µ–∑ —Å–≤—è–∑–µ–π)
- [x] –ú–Ω–æ–≥–æ–ø—Ä–æ—Ö–æ–¥–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Purge Unused
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–≤—è–∑–µ–π

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –†–ù —á–µ—Ä–µ–∑ UI
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ –ø–æ–¥–ø–∞–ø–∫–∏ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞–º
- [ ] –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –ø–æ–∑–≤–æ–ª–∏—Ç Revit API)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ CSV —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ñ–∞–π–ª–æ–≤ –¥–æ/–ø–æ—Å–ª–µ
- [ ] –û–ø—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- [ ] –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ purgeable —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

# WW.BIM Update Script

## Описание
Скрипт автоматического обновления PyRevit extension WW.BIM из GitHub репозитория.

## Репозиторий
- **GitHub:** https://github.com/sezif5/WW.BIM
- **Ветка:** main (с автоматическим fallback на master)

## Файлы
- `Update_script.py` — основной скрипт обновления для PyRevit

## Как работает
1. Скрипт получает текущую версию из локального `version.txt`
2. Запрашивает версию с GitHub (raw.githubusercontent.com)
3. Сравнивает версии
4. Если есть обновление — скачивает ZIP архив репозитория
5. Распаковывает во временную папку
6. Копирует файлы в папку extension (кроме пользовательских настроек)
7. Очищает временные файлы

## Установка в PyRevit Extension

### Структура папок
```
WW.BIM.extension/
├── version.txt                    ← файл версии в корне
└── WW.BIM.tab/
    └── Настройки.panel/
        └── Обновить.pushbutton/
            ├── script.py          ← Update_script.py
            └── icon.png           ← иконка 32x32 (опционально)
```

### Настройки в скрипте (строки 17-21)
```python
GITHUB_USER = "sezif5"
GITHUB_REPO = "WW.BIM"
BRANCH = "main"
EXTENSION_NAME = "WW.BIM.extension"
```

## Требования
- PyRevit установлен
- Доступ к интернету (github.com)
- Python 2.7+ или Python 3.x (совместим с обоими)

## Формат version.txt
Простой текстовый файл с номером версии:
```
1.0.0
```

Рекомендуется семантическое версионирование: MAJOR.MINOR.PATCH

## Файлы которые НЕ перезаписываются
- `user_config.json`
- `local_settings.py`
- `.user`
- Любые файлы начинающиеся с `.git`

## Возможные доработки
- [ ] Добавить changelog — показывать что нового в версии
- [ ] Резервное копирование перед обновлением
- [ ] Проверка совместимости с версией Revit
- [ ] Уведомление о новой версии при запуске Revit (startup script)

## Troubleshooting

### "Не удалось подключиться к серверу"
- Проверьте интернет-соединение
- Проверьте доступ к github.com (корпоративный firewall?)
- Проверьте правильность GITHUB_USER и GITHUB_REPO

### "Не удалось определить путь к плагину"
- Скрипт должен находиться внутри папки .extension
- Или выберите папку вручную в диалоговом окне

### Обновление не применяется
- Перезапустите Revit после обновления
- Проверьте права на запись в папку extension

<Window xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation'
        xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml'
        Title='Добавление общих параметров в проект'
        Height='750' Width='1000' MinHeight='600' MinWidth='850'
        WindowStartupLocation='CenterScreen'
        Background='#F5F5F5'>

  <Window.Resources>
    <Style TargetType='GroupBox'>
      <Setter Property='Padding' Value='10'/>
      <Setter Property='Margin' Value='0,0,0,10'/>
    </Style>
    <Style TargetType='Button'>
      <Setter Property='Padding' Value='12,6'/>
      <Setter Property='MinWidth' Value='90'/>
    </Style>
    <Style TargetType='TextBlock'>
      <Setter Property='Margin' Value='0,0,0,4'/>
    </Style>
    <Style TargetType='ListBox'>
      <Setter Property='BorderThickness' Value='1'/>
      <Setter Property='BorderBrush' Value='#CCCCCC'/>
    </Style>
    <Style TargetType='DataGrid'>
      <Setter Property='BorderThickness' Value='1'/>
      <Setter Property='BorderBrush' Value='#CCCCCC'/>
      <Setter Property='GridLinesVisibility' Value='Horizontal'/>
      <Setter Property='HorizontalGridLinesBrush' Value='#EEEEEE'/>
    </Style>
    <Style TargetType='CheckBox' x:Key='CategoryCheckBox'>
      <Setter Property='Margin' Value='2'/>
    </Style>
  </Window.Resources>

  <Grid Margin='15'>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width='280' MinWidth='250'/>
      <ColumnDefinition Width='15'/>
      <ColumnDefinition Width='*'/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height='*'/>
      <RowDefinition Height='Auto'/>
    </Grid.RowDefinitions>

    <!-- Левая панель: Выбор параметров -->
    <Grid Grid.Column='0' Grid.Row='0'>
      <Grid.RowDefinitions>
        <RowDefinition Height='*'/>
        <RowDefinition Height='Auto'/>
        <RowDefinition Height='*'/>
      </Grid.RowDefinitions>

      <GroupBox Header='Группа параметров ФОП:' Grid.Row='0'>
        <ListBox x:Name='lbGroups'/>
      </GroupBox>

      <GroupBox Header='Параметры:' Grid.Row='2'>
        <ListBox x:Name='lbParams' SelectionMode='Extended'/>
      </GroupBox>
    </Grid>

    <!-- Правая панель -->
    <Grid Grid.Column='2' Grid.Row='0'>
      <Grid.RowDefinitions>
        <RowDefinition Height='Auto'/>
        <RowDefinition Height='*' MinHeight='200'/>
        <RowDefinition Height='Auto'/>
        <RowDefinition Height='*' MinHeight='150'/>
      </Grid.RowDefinitions>

      <!-- Настройки -->
      <Border Grid.Row='0' Background='#FFFFFF' BorderBrush='#DDDDDD' BorderThickness='1' CornerRadius='4' Padding='12' Margin='0,0,0,10'>
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width='Auto'/>
            <ColumnDefinition Width='25'/>
            <ColumnDefinition Width='Auto'/>
            <ColumnDefinition Width='*'/>
            <ColumnDefinition Width='Auto'/>
          </Grid.ColumnDefinitions>

          <StackPanel Grid.Column='0'>
            <TextBlock Text='Группирование:' FontWeight='SemiBold'/>
            <ComboBox x:Name='cbBipg' MinWidth='180' VerticalAlignment='Center'/>
          </StackPanel>

          <StackPanel Grid.Column='2'>
            <TextBlock Text='Добавить как:' FontWeight='SemiBold'/>
            <StackPanel Orientation='Horizontal' Margin='0,6,0,0'>
              <RadioButton x:Name='rbType' Content='Тип' Margin='0,0,20,0' VerticalAlignment='Center'/>
              <RadioButton x:Name='rbInst' Content='Экземпляр' IsChecked='True' VerticalAlignment='Center'/>
            </StackPanel>
          </StackPanel>

          <Button x:Name='btnAdd' Grid.Column='4' Content='Добавить в очередь' VerticalAlignment='Bottom' MinWidth='140'/>
        </Grid>
      </Border>

      <!-- Выбор категорий -->
      <GroupBox Grid.Row='1' Header='Категории модели:'>
        <DockPanel>
          <StackPanel DockPanel.Dock='Top' Orientation='Horizontal' Margin='0,0,0,8'>
            <Button x:Name='btnPresetAll' Content='Все моделируемые' Margin='0,0,8,0' Padding='8,4'/>
            <Button x:Name='btnPresetArch' Content='Архитектура' Margin='0,0,8,0' Padding='8,4'/>
            <Button x:Name='btnPresetMep' Content='Инженерия' Margin='0,0,8,0' Padding='8,4'/>
            <Button x:Name='btnPresetStruct' Content='Конструкции' Margin='0,0,8,0' Padding='8,4'/>
            <Button x:Name='btnClearCats' Content='Очистить' Padding='8,4'/>
          </StackPanel>
          <TextBox x:Name='tbCategoryFilter' DockPanel.Dock='Top' Margin='0,0,0,8'
                   ToolTip='Фильтр категорий...' Text='' />
          <ListBox x:Name='lbCategories' SelectionMode='Extended'>
            <ListBox.ItemTemplate>
              <DataTemplate>
                <CheckBox Content='{Binding Name}' IsChecked='{Binding IsSelected, Mode=TwoWay}'
                          Style='{StaticResource CategoryCheckBox}'/>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </DockPanel>
      </GroupBox>

      <!-- Кнопка добавления -->
      <Border Grid.Row='2' Padding='0,0,0,10'>
        <StackPanel Orientation='Horizontal' HorizontalAlignment='Right'>
          <TextBlock Text='Выбрано категорий: ' VerticalAlignment='Center' Margin='0,0,4,0'/>
          <TextBlock x:Name='tbSelectedCount' Text='0' VerticalAlignment='Center' FontWeight='Bold' Margin='0,0,15,0'/>
        </StackPanel>
      </Border>

      <!-- Очередь -->
      <GroupBox Grid.Row='3' Header='Очередь добавления' Margin='0'>
        <DockPanel>
          <StackPanel DockPanel.Dock='Bottom' Orientation='Horizontal' Margin='0,10,0,0'>
            <Button x:Name='btnOpenQueue' Content='Открыть...' Margin='0,0,8,0'/>
            <Button x:Name='btnSaveQueue' Content='Сохранить...' Margin='0,0,8,0'/>
            <Button x:Name='btnRemove' Content='Удалить'/>
          </StackPanel>

          <DataGrid x:Name='dgQueue' AutoGenerateColumns='False' CanUserAddRows='False'
                    IsReadOnly='True' SelectionMode='Extended' HeadersVisibility='Column'
                    RowHeight='26' ColumnHeaderHeight='28'>
            <DataGrid.Columns>
              <DataGridTextColumn Header='Параметр' Binding='{Binding Name}' Width='*' MinWidth='150'/>
              <DataGridTextColumn Header='Тип/Экз' Binding='{Binding BindingTypeText}' Width='70'/>
              <DataGridTextColumn Header='Группирование' Binding='{Binding BipgText}' Width='150'/>
              <DataGridTextColumn Header='Категории' Binding='{Binding CategoriesText}' Width='200'/>
            </DataGrid.Columns>
          </DataGrid>
        </DockPanel>
      </GroupBox>
    </Grid>

    <!-- Нижняя панель -->
    <Border Grid.Row='1' Grid.ColumnSpan='3' BorderBrush='#DDDDDD' BorderThickness='0,1,0,0'
            Margin='-15,15,-15,0' Padding='15,15,15,0'>
      <StackPanel Orientation='Horizontal' HorizontalAlignment='Right'>
        <Button x:Name='btnOk' Content='Выполнить' MinWidth='110' Margin='0,0,10,0'/>
        <Button x:Name='btnCancel' Content='Отмена' MinWidth='100'/>
      </StackPanel>
    </Border>

  </Grid>
</Window>
